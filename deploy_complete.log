2025-11-12 18:18:59 (31.6 MB/s) - '/var/lib/vz/template/cache/ubuntu-24.10-standard_24.10-1_amd64.tar.zst.tmp_dwnl.1933908' saved [143472532/143472532]
calculating checksum...OK, checksum verified
download of 'http://download.proxmox.com/images/system/ubuntu-24.10-standard_24.10-1_amd64.tar.zst' to '/var/lib/vz/template/cache/ubuntu-24.10-standard_24.10-1_amd64.tar.zst' finished
Formatting '/mnt/pve/sdb/images/3010/vm-3010-disk-0.raw', fmt=raw size=21474836480 preallocation=off
Creating filesystem with 5242880 4k blocks and 1310720 inodes
Filesystem UUID: 54544471-0fa3-46fb-b347-cb51ac909053
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
extracting archive '/var/lib/vz/template/cache/ubuntu-24.10-standard_24.10-1_amd64.tar.zst'
Total bytes read: 570439680 (545MiB, 200MiB/s)
Creating SSH host key 'ssh_host_ecdsa_key' - this may take some time ...
done: SHA256:ntx3iWvT0pjijgqmzqAwTK1xm6K53ar3or5CwMVuWYU root@ubuntu-tmpl
Creating SSH host key 'ssh_host_dsa_key' - this may take some time ...
done: SHA256:Hp+cC5mnX5k8jNSpruiTNLIllVVwJszdJMyFlDfBVqY root@ubuntu-tmpl
Creating SSH host key 'ssh_host_rsa_key' - this may take some time ...
done: SHA256:y/5VROogfvx9jq7+7uh8zl8peZrgqWZDBHQkpuIcDV4 root@ubuntu-tmpl
Creating SSH host key 'ssh_host_ed25519_key' - this may take some time ...
done: SHA256:3SJrJQJT7yK2p+y0mqGaqpAURLMQtz05w1KfnhS4YBo root@ubuntu-tmpl
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/plucky/InRelease  Could not connect to 10.11.3.20:3142 (10.11.3.20). - connect (113: No route to host)
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/plucky-updates/InRelease  Unable to connect to 10.11.3.20:3142:
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/plucky-security/InRelease  Unable to connect to 10.11.3.20:3142:
W: Some index files failed to download. They have been ignored, or old ones used instead.
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/plucky/InRelease  Could not connect to 10.11.3.20:3142 (10.11.3.20). - connect (113: No route to host)
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/plucky-updates/InRelease  Unable to connect to 10.11.3.20:3142:
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/plucky-security/InRelease  Unable to connect to 10.11.3.20:3142:
W: Some index files failed to download. They have been ignored, or old ones used instead.
INFO: backup mode: stop
INFO: ionice priority: 7
INFO: CT Name: ubuntu-tmpl
INFO: including mount point rootfs ('/') in backup
INFO: creating vzdump archive '/var/lib/vz/template/cache/vzdump-lxc-3010-2025_11_12-18_20_18.tar.zst'
INFO: Total bytes written: 519096320 (496MiB, 89MiB/s)
INFO: archive file size: 151MB
INFO: Finished Backup of VM 3010 (00:00:06)
INFO: Backup finished at 2025-11-12 18:20:24
INFO: Backup job finished successfully
-rw-r--r-- 1 root root 152M Nov 12 18:20 /var/lib/vz/template/cache/ubuntu-25.04-template_20251112_amd64.tar.zst
Formatting '/mnt/pve/sdb/images/3008/vm-3008-disk-0.raw', fmt=raw size=42949672960 preallocation=off
Creating filesystem with 10485760 4k blocks and 2621440 inodes
Filesystem UUID: 5e725f3b-c875-4e84-9213-f367d7d88d33
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
	4096000, 7962624
extracting archive '/var/lib/vz/template/cache/ubuntu-24.10-standard_24.10-1_amd64.tar.zst'
Total bytes read: 570439680 (545MiB, 187MiB/s)
Creating SSH host key 'ssh_host_ecdsa_key' - this may take some time ...
done: SHA256:i0IodeH0XnNsid1ndz78aXs4Xgu8eUg2/IIruPvTino root@docker-tmpl
Creating SSH host key 'ssh_host_dsa_key' - this may take some time ...
done: SHA256:zFcg4GT9NJ9irSJFo8UmuGCCwjIyuyYjmdlRiHjjtFw root@docker-tmpl
Creating SSH host key 'ssh_host_ed25519_key' - this may take some time ...
done: SHA256:aWvjXZZXik/tSutjXk8bQC1Rc+JawvSgFS394uVY6tQ root@docker-tmpl
Creating SSH host key 'ssh_host_rsa_key' - this may take some time ...
done: SHA256:AwGXkSQ3oamTFwXIllSkmyCMQf6nLrQ+NHGS5IRQ7Fk root@docker-tmpl
jaal ALL=(ALL) NOPASSWD: ALL
# Host 10.11.3.8 found: line 176
Setting up python3-distupgrade (1:25.04.18) ...
Setting up ubuntu-release-upgrader-core (1:25.04.18) ...
Installing new version of config file /etc/update-motd.d/91-release-upgrade ...
Setting up update-manager-core (1:25.04.5) ...
Processing triggers for debianutils (5.21) ...
Processing triggers for install-info (7.1.1-1) ...
Processing triggers for libc-bin (2.41-6ubuntu1.2) ...
Processing triggers for systemd (257.4-1ubuntu3.2) ...
Processing triggers for postfix (3.9.1-10ubuntu1) ...
Restarting postfix
Synchronizing state of docker.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable docker
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_CTYPE = (unset),
	LC_NUMERIC = (unset),
	LC_COLLATE = (unset),
	LC_TIME = (unset),
	LC_MESSAGES = (unset),
	LC_MONETARY = (unset),
	LC_ADDRESS = (unset),
	LC_IDENTIFICATION = (unset),
	LC_MEASUREMENT = (unset),
	LC_PAPER = (unset),
	LC_TELEPHONE = (unset),
	LC_NAME = (unset),
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_CTYPE = (unset),
	LC_NUMERIC = (unset),
	LC_COLLATE = (unset),
	LC_TIME = (unset),
	LC_MESSAGES = (unset),
	LC_MONETARY = (unset),
	LC_ADDRESS = (unset),
	LC_IDENTIFICATION = (unset),
	LC_MEASUREMENT = (unset),
	LC_PAPER = (unset),
	LC_TELEPHONE = (unset),
	LC_NAME = (unset),
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
Docker version 29.0.0, build 3d4129b
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
Total reclaimed space: 0B
INFO: creating vzdump archive '/var/lib/vz/template/cache/vzdump-lxc-3008-2025_11_12-18_24_25.tar.zst'
INFO: archive file size: 348MB
INFO: Finished Backup of VM 3008 (00:00:12)
Template created: docker-ubuntu25.04-template_20251112_amd64.tar.zst
update successful
Formatting '/mnt/pve/sdb/images/3020/vm-3020-disk-0.raw', fmt=raw size=21474836480 preallocation=off
Creating filesystem with 5242880 4k blocks and 1310720 inodes
Filesystem UUID: 88b47a4d-d9b6-4835-bcb2-e3e04f9d0d79
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
extracting archive '/var/lib/vz/template/cache/ubuntu-25.04-template_20251112_amd64.tar.zst'
tar: ./var/spool/postfix/dev/random: Cannot mknod: Operation not permitted
tar: ./var/spool/postfix/dev/urandom: Cannot mknod: Operation not permitted
Total bytes read: 519096320 (496MiB, 248MiB/s)
tar: Exiting with failure status due to previous errors
unable to create CT 3020 - command 'lxc-usernsexec -m u:0:100000:65536 -m g:0:100000:65536 -- tar xpf - --zstd --totals --one-file-system -p --sparse --numeric-owner --acls --xattrs '--xattrs-include=user.*' '--xattrs-include=security.capability' '--warning=no-file-ignored' '--warning=no-xattr-write' -C /var/lib/lxc/3020/rootfs --skip-old-files --anchored --exclude './dev/*'' failed: exit code 2
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
# Host 10.11.3.20 found: line 172
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Configuration file 'nodes/pve/lxc/3020.conf' does not exist
Formatting '/mnt/pve/sdb/images/3018/vm-3018-disk-0.raw', fmt=raw size=32212254720 preallocation=off
Creating filesystem with 7864320 4k blocks and 1966080 inodes
Filesystem UUID: 69d6c46c-3715-405b-8ac7-1de9e1ff0bb8
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
extracting archive '/var/lib/vz/template/cache/ubuntu-25.04-template_20251112_amd64.tar.zst'
tar: ./var/spool/postfix/dev/random: Cannot mknod: Operation not permitted
tar: ./var/spool/postfix/dev/urandom: Cannot mknod: Operation not permitted
Total bytes read: 519096320 (496MiB, 249MiB/s)
tar: Exiting with failure status due to previous errors
unable to create CT 3018 - command 'lxc-usernsexec -m u:0:100000:65536 -m g:0:100000:65536 -- tar xpf - --zstd --totals --one-file-system -p --sparse --numeric-owner --acls --xattrs '--xattrs-include=user.*' '--xattrs-include=security.capability' '--warning=no-file-ignored' '--warning=no-xattr-write' -C /var/lib/lxc/3018/rootfs --skip-old-files --anchored --exclude './dev/*'' failed: exit code 2
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Configuration file 'nodes/pve/lxc/3018.conf' does not exist
Formatting '/mnt/pve/sdb/images/3017/vm-3017-disk-0.raw', fmt=raw size=10737418240 preallocation=off
Creating filesystem with 2621440 4k blocks and 655360 inodes
Filesystem UUID: e8061aa2-5fe2-43ff-a31c-fc313855885c
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632
extracting archive '/var/lib/vz/template/cache/ubuntu-25.04-template_20251112_amd64.tar.zst'
Total bytes read: 519096320 (496MiB, 219MiB/s)
Creating SSH host key 'ssh_host_rsa_key' - this may take some time ...
done: SHA256:YANIbxBWZXEDpFl2TY1MEWFy21JPQ7B/KnspxlPOnkg root@haproxy
Creating SSH host key 'ssh_host_dsa_key' - this may take some time ...
done: SHA256:EGfcOvk9wvPGUJnqFaoKlNZ9q9srjxnP2QymVrFp5H4 root@haproxy
Creating SSH host key 'ssh_host_ecdsa_key' - this may take some time ...
done: SHA256:49H7ghxXrfcRH82Aor7lPoFriT0akTEGjjD8tZl6bfM root@haproxy
Creating SSH host key 'ssh_host_ed25519_key' - this may take some time ...
done: SHA256:lU4pcQuE7jeMDe9gKIHoVw/gdb5IYyeEegGH0QIIFic root@haproxy
User exists
jaal ALL=(ALL) NOPASSWD: ALL
# Host 10.11.3.17 found: line 171

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Error: Unable to locate package haproxy
bash: line 1: /etc/haproxy/haproxy.cfg: No such file or directory
Failed to enable unit: Unit haproxy.service does not exist
bash: line 1: haproxy: command not found
Formatting '/mnt/pve/sdb/images/3005/vm-3005-disk-0.raw', fmt=raw size=42949672960 preallocation=off
Creating filesystem with 10485760 4k blocks and 2621440 inodes
Filesystem UUID: 5478f0bd-14b4-44db-90c4-085cc7282df9
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
	4096000, 7962624
extracting archive '/var/lib/vz/template/cache/docker-ubuntu25.04-template_20251112_amd64.tar.zst'
Total bytes read: 1161687040 (1.1GiB, 287MiB/s)
Creating SSH host key 'ssh_host_ed25519_key' - this may take some time ...
done: SHA256:M9SU41NiDWpi3O0lYP4K8xxtu26dGYAlIVOlE/Dqw3U root@swarm-manager
Creating SSH host key 'ssh_host_ecdsa_key' - this may take some time ...
done: SHA256:NZN9jsEhc1vQ9XP0uMLtPKjF6JA2ad4u8bnolnMr3B4 root@swarm-manager
Creating SSH host key 'ssh_host_dsa_key' - this may take some time ...
done: SHA256:JZSHuk+nguArWhaxsTX6u53pd5e2kHWeFBQkE49nU3c root@swarm-manager
Creating SSH host key 'ssh_host_rsa_key' - this may take some time ...
done: SHA256:jMbRp1V3Tyot0xyinUdsMvXHXaJ6MQpjWztOzoKttu4 root@swarm-manager
# Host 10.11.3.5 found: line 177
# Host 10.11.3.5 found: line 178
# Host 10.11.3.5 found: line 179
net.ipv4.ip_unprivileged_port_start = 0
Formatting '/mnt/pve/sdb/images/3006/vm-3006-disk-0.raw', fmt=raw size=42949672960 preallocation=off
Creating filesystem with 10485760 4k blocks and 2621440 inodes
Filesystem UUID: cf0acd62-89d2-4b20-93bb-36f5ef5bbd68
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
	4096000, 7962624
extracting archive '/var/lib/vz/template/cache/docker-ubuntu25.04-template_20251112_amd64.tar.zst'
Total bytes read: 1161687040 (1.1GiB, 257MiB/s)
Creating SSH host key 'ssh_host_dsa_key' - this may take some time ...
done: SHA256:fGP6vMpacNCwqxa+whnpl+lCH68OSmmbJg4YeOrv1fA root@swarm-node-1
Creating SSH host key 'ssh_host_ed25519_key' - this may take some time ...
done: SHA256:i6g7YdL/qUumfZTzGAQmbcPXjNCPOf1urQ2F6MzvQPg root@swarm-node-1
Creating SSH host key 'ssh_host_rsa_key' - this may take some time ...
done: SHA256:3Bht0fqcUmIYoKOTF7xVCigQpFW2CIDgqlNhxPefxos root@swarm-node-1
Creating SSH host key 'ssh_host_ecdsa_key' - this may take some time ...
done: SHA256:1na/1y1PVC/7a1m/Yq/kYi62FU/XO63uDyk6gXB/m60 root@swarm-node-1
# Host 10.11.3.6 found: line 166
Formatting '/mnt/pve/sdb/images/3007/vm-3007-disk-0.raw', fmt=raw size=42949672960 preallocation=off
Creating filesystem with 10485760 4k blocks and 2621440 inodes
Filesystem UUID: be7207b0-c0f8-4aca-99b3-d012b4f11241
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
	4096000, 7962624
extracting archive '/var/lib/vz/template/cache/docker-ubuntu25.04-template_20251112_amd64.tar.zst'
Total bytes read: 1161687040 (1.1GiB, 287MiB/s)
Creating SSH host key 'ssh_host_ed25519_key' - this may take some time ...
done: SHA256:XYEajabBYq9wyKWy0j6YwWLep3UkzYEucqmjy5kj9GY root@swarm-node-2
Creating SSH host key 'ssh_host_dsa_key' - this may take some time ...
done: SHA256:OFxunUeI4npz4VAo04MOkikxYbzEsgjpPTOrEtkN/1s root@swarm-node-2
Creating SSH host key 'ssh_host_rsa_key' - this may take some time ...
done: SHA256:vXSrcmWaDlWsdU785MAFhLae87Zh/N1We5A6CCoaWxo root@swarm-node-2
Creating SSH host key 'ssh_host_ecdsa_key' - this may take some time ...
done: SHA256:Z8bY+RtYTBv1di1dWzmJbS5LjDv0n9B+dbLSJyYLb1s root@swarm-node-2
# Host 10.11.3.7 found: line 167
Synchronizing state of docker.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable docker
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_CTYPE = (unset),
	LC_NUMERIC = (unset),
	LC_COLLATE = (unset),
	LC_TIME = (unset),
	LC_MESSAGES = (unset),
	LC_MONETARY = (unset),
	LC_ADDRESS = (unset),
	LC_IDENTIFICATION = (unset),
	LC_MEASUREMENT = (unset),
	LC_PAPER = (unset),
	LC_TELEPHONE = (unset),
	LC_NAME = (unset),
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_CTYPE = (unset),
	LC_NUMERIC = (unset),
	LC_COLLATE = (unset),
	LC_TIME = (unset),
	LC_MESSAGES = (unset),
	LC_MONETARY = (unset),
	LC_ADDRESS = (unset),
	LC_IDENTIFICATION = (unset),
	LC_MEASUREMENT = (unset),
	LC_PAPER = (unset),
	LC_TELEPHONE = (unset),
	LC_NAME = (unset),
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
● docker.service - Docker Application Container Engine
     Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; preset: enabled)
     Active: active (running) since Wed 2025-11-12 17:33:15 UTC; 2min 8s ago
 Invocation: 28756a39688f414da67107c2707152fb
TriggeredBy: ● docker.socket
swarm-manager
ID                            HOSTNAME        STATUS    AVAILABILITY   MANAGER STATUS   ENGINE VERSION
b65j7w79apuhspsdg1ms8721l *   swarm-manager   Ready     Drain          Leader           29.0.0
qmlf2ow0e01mwgtmo1636170s     swarm-node-1    Ready     Active                          29.0.0
m6ess0swn9pzk5vlo1av47xva     swarm-node-2    Ready     Active                          29.0.0
portainer_data
Unable to find image 'portainer/portainer-ce:latest' locally
latest: Pulling from portainer/portainer-ce
4f4fb700ef54: Pulling fs layer
9f7772ceb88a: Pulling fs layer
089b96337e3d: Pulling fs layer
22d4f45bf667: Pulling fs layer
c551c6af3241: Pulling fs layer
f3e139b9cd66: Pulling fs layer
2d896f38a01e: Pulling fs layer
d35c85f36345: Pulling fs layer
4f4fb700ef54: Download complete
089b96337e3d: Download complete
22d4f45bf667: Download complete
2d896f38a01e: Download complete
9f7772ceb88a: Download complete
089b96337e3d: Pull complete
22d4f45bf667: Pull complete
f3e139b9cd66: Download complete
c551c6af3241: Download complete
d35c85f36345: Download complete
9f7772ceb88a: Pull complete
c551c6af3241: Pull complete
d35c85f36345: Pull complete
4f4fb700ef54: Pull complete
2d896f38a01e: Pull complete
f3e139b9cd66: Pull complete
Digest: sha256:d38a6876b61df32e4da13c0ca61cf2aa0f27afc103abb4ca7ad4e1cf000e17c3
Status: Downloaded newer image for portainer/portainer-ce:latest
99efce45b243c80aaa44697f5f25266c74dfd5aef3e9e1da694e37889043f150
peer probe: failed: Probe returned with Transport endpoint is not connected
peer probe: success
peer probe: failed: Probe returned with Transport endpoint is not connected
peer probe: success
Mounting glusterfs on /mnt/gluster failed.
Mounting glusterfs on /mnt/gluster failed.
==================================================
Deploying Lab Environment
==================================================

[1/3] Creating template 'ubuntu-tmpl' (type: ubuntu)...
Base template not found. Downloading ubuntu-24.10-standard_24.10-1_amd64.tar.zst...
Creating container 3010...
Configuring container features...
Starting container...
Container is up (pct exec working)!
Configuring apt cache...
Fixing apt sources...
Setting up user and SSH access...
Upgrading distribution to latest (25.04)...
Installing minimal base tools...
Cleanup for template...
Stopping container...
Creating template archive...
Cleaning up other template archives...
  Destroying existing container 3010...
✓ Ubuntu template 'ubuntu-tmpl' created

[2/3] Creating template 'docker-tmpl' (type: ubuntu+docker)...
Creating container 3008...
Configuring container features...
Starting container...
Container is up (pct exec working)!
Creating user and configuring sudo...
Fixing apt sources...
Updating package lists...
Installing prerequisites...
Upgrading to latest Ubuntu distribution (25.04)...
Installing Docker...
Verifying Docker install...
Configuring Docker user group...
Starting Docker service...
Disabling AppArmor for Docker...
Verifying Docker installation...
Cleaning up container-specific data for template...
Stopping container...
Creating template from container...
Cleaning up other template archives...
  Destroying existing container 3008...
✓ Docker template 'docker-tmpl' created

[3/3] Creating container 'apt-cache' (type: apt-cache)...
Creating container 3020 from template...
Starting container...
Configuring network...
Waiting... (1/30)
Waiting... (2/30)
Waiting... (3/30)
Waiting... (4/30)
Waiting... (5/30)
Waiting... (6/30)
Waiting... (7/30)
Waiting... (8/30)
Waiting... (9/30)
Waiting... (10/30)
Waiting... (11/30)
Waiting... (12/30)
Waiting... (13/30)
Waiting... (14/30)
Waiting... (15/30)
Waiting... (16/30)
Waiting... (17/30)
Waiting... (18/30)
Waiting... (19/30)
Waiting... (20/30)
Waiting... (21/30)
Waiting... (22/30)
Waiting... (23/30)
Waiting... (24/30)
Waiting... (25/30)
Waiting... (26/30)
Waiting... (27/30)
Waiting... (28/30)
Waiting... (29/30)
Waiting... (30/30)
WARNING: Container may not be fully ready, but continuing...
Creating user and configuring sudo...
Setting up SSH key...
Configuring DNS...
Fixing apt sources...
Updating package lists...
Upgrading to latest Ubuntu distribution (25.04)...
Installing apt-cacher-ng...
Configuring apt-cacher-ng to use port 3142...
Starting apt-cacher-ng service...
✓ apt-cache container 'apt-cache' created

[4/3] Creating container 'pgsql' (type: pgsql)...
Creating container 3018 from template...
Starting container...
Configuring network...
Waiting... (1/30)
Waiting... (2/30)
Waiting... (3/30)
Waiting... (4/30)
Waiting... (5/30)
Waiting... (6/30)
Waiting... (7/30)
Waiting... (8/30)
Waiting... (9/30)
Waiting... (10/30)
Waiting... (11/30)
Waiting... (12/30)
Waiting... (13/30)
Waiting... (14/30)
Waiting... (15/30)
Waiting... (16/30)
Waiting... (17/30)
Waiting... (18/30)
Waiting... (19/30)
Waiting... (20/30)
Waiting... (21/30)
Waiting... (22/30)
Waiting... (23/30)
Waiting... (24/30)
Waiting... (25/30)
Waiting... (26/30)
Waiting... (27/30)
Waiting... (28/30)
Waiting... (29/30)
Waiting... (30/30)
WARNING: Container may not be fully ready, but continuing...
Creating user and configuring sudo...
Setting up SSH key...
Configuring DNS...
Fixing apt sources...
Configuring apt cache...
Updating package lists...
Upgrading to latest Ubuntu distribution (25.04)...
Installing PostgreSQL 17...
Configuring PostgreSQL...
Configuring PostgreSQL network settings...
⚠ PostgreSQL may not be running
✓ PostgreSQL container 'pgsql' created

[5/3] Creating container 'haproxy' (type: haproxy)...
Creating container 3017 from template...
Starting container...
Configuring network...
Container is up!
Creating user and configuring sudo...
Setting up SSH key...
Configuring DNS...
Fixing apt sources...
Configuring apt cache...
Installing HAProxy...
Configuring HAProxy...
Configuring HAProxy systemd service for LXC...
Starting HAProxy service...
Systemd start failed, starting HAProxy manually...
✓ HAProxy installed and running
✓ HAProxy container 'haproxy' created

[6/3] Deploying Docker Swarm...
Using template: /var/lib/vz/template/cache/docker-ubuntu25.04-template_20251112_amd64.tar.zst

Deploying container 3005 (swarm-manager)...
Creating container 3005 from template...
Configuring container features...
Configuring LXC container for sysctl access...
Starting container...
Container is up (pct exec working)!
Setting up SSH key...
Configuring apt cache...
Verifying Docker installation...
Ensuring SSH service is running on manager...
Configuring sysctl for Docker containers...
✓ Container 3005 (swarm-manager) deployed successfully

Deploying container 3006 (swarm-node-1)...
Creating container 3006 from template...
Configuring container features...
Starting container...
Container is up!
Setting up SSH key...
Configuring apt cache...
Verifying Docker installation...
✓ Container 3006 (swarm-node-1) deployed successfully

Deploying container 3007 (swarm-node-2)...
Creating container 3007 from template...
Configuring container features...
Starting container...
Container is up!
Setting up SSH key...
Configuring apt cache...
Verifying Docker installation...
✓ Container 3007 (swarm-node-2) deployed successfully
Starting Docker service on manager...

Initializing Docker Swarm on manager node...
Swarm initialized successfully
Getting worker join token...
Setting manager node availability to drain...
Joining swarm-node-1 (10.11.3.6) to swarm...
✓ Node swarm-node-1 joined swarm successfully
Joining swarm-node-2 (10.11.3.7) to swarm...
✓ Node swarm-node-2 joined swarm successfully

Verifying swarm status...

Installing Portainer CE...
Creating Portainer container...
Verifying Portainer is running...
Portainer status: portainer Up 12 seconds
✓ Docker Swarm deployed

[7/3] Setting up GlusterFS distributed storage...

[5/7] Setting up GlusterFS distributed storage...
Installing GlusterFS server on all nodes...
  Fixing apt sources on swarm-manager...
  Fixing apt sources on swarm-node-1...
  Fixing apt sources on swarm-node-2...
  Installing on swarm-manager...
    ✓ swarm-manager: GlusterFS installed and glusterd running
  Installing on swarm-node-1...
    ✓ swarm-node-1: GlusterFS installed and glusterd running
  Installing on swarm-node-2...
    ✓ swarm-node-2: GlusterFS installed and glusterd running
Creating brick directories on worker nodes...
  Creating brick on swarm-node-1...
  Creating brick on swarm-node-2...
Peering worker nodes together...
  Adding swarm-node-1 (10.11.3.6) to cluster...
  Adding swarm-node-2 (10.11.3.7) to cluster...
Verifying peer status...
Number of Peers: 2

Hostname: 10.11.3.6
Uuid: 1f50efcc-389a-46a7-953b-8ab9e61d1e3b
State: Peer in Cluster (Connected)

Hostname: 10.11.3.7
Uuid: 212fa400-d6a6-4d65-9aca-e9d93a7b56d4
State: Peer in Cluster (Connected)
  ✓ All 2 worker peers connected
Creating GlusterFS volume 'swarm-storage'...
  volume create: swarm-storage: success: please start the volume to access data
Starting volume 'swarm-storage'...
  volume start: swarm-storage: success
Verifying volume status...
Status of volume: swarm-storage
Gluster process                             TCP Port  RDMA Port  Online  Pid
------------------------------------------------------------------------------
Brick 10.11.3.6:/gluster/brick              60717     0          Y       2068 
Brick 10.11.3.7:/gluster/brick              50015     0          Y       2070 
Self-heal Daemon on localhost               N/A       N/A        Y       2468 
Self-heal Daemon on 10.11.3.6               N/A       N/A        Y       2085 
Self-heal Daemon on 10.11.3.7               N/A       N/A        Y       2087 
 
Task Status of Volume swarm-storage
------------------------------------------------------------------------------
There are no active volume tasks
Mounting GlusterFS volume on all nodes...
  Mounting on swarm-manager...
    ✓ swarm-manager: Volume mounted successfully
  Mounting on swarm-node-1...
    ✓ swarm-node-1: Volume mounted successfully
  Mounting on swarm-node-2...
    ✓ swarm-node-2: Volume mounted successfully
✓ GlusterFS distributed storage setup complete
  Volume: swarm-storage
  Mount point: /mnt/gluster on all nodes
  Replication: 2x

==================================================
Deployment Complete!
==================================================

Containers:
  - 3020: apt-cache (10.11.3.20)
  - 3018: pgsql (10.11.3.18)
  - 3017: haproxy (10.11.3.17)
  - 3005: swarm-manager (10.11.3.5)
  - 3006: swarm-node-1 (10.11.3.6)
  - 3007: swarm-node-2 (10.11.3.7)

Portainer: https://10.11.3.5:9443
PostgreSQL: 10.11.3.18:5432
HAProxy: http://10.11.3.17:80 (Stats: http://10.11.3.17:8404)

GlusterFS:
  Volume: swarm-storage
  Mount: /mnt/gluster on all nodes
